(self.webpackChunksparkworks_console=self.webpackChunksparkworks_console||[]).push([[549],{19549:function(e,t,n){"use strict";n.r(t),n.d(t,{amplify_confirm_sign_in:function(){return y},amplify_confirm_sign_up:function(){return F},amplify_forgot_password:function(){return w},amplify_require_new_password:function(){return _},amplify_sign_in:function(){return I},amplify_sign_up:function(){return T},amplify_verify_contact:function(){return S}});var r=n(15121),i=n(16304),a=n(31112),s=n(41998),u=n(88774),o=n.n(u),h=n(65513),l=n(53799),d=n(6860),p=n(77),c=n(82073),m=n(33542),f=n(30031),g=n(68513),b=n(10027),v=n(86757),y=function(){function e(t){var n=this;(0,a.Z)(this,e),(0,h.r)(this,t),this.handleSubmit=function(e){return n.confirm(e)},this.headerText=f.T.CONFIRM_SMS_CODE,this.submitButtonText=f.T.CONFIRM,this.handleAuthStateChange=b.d,this.defaultFormFields=[{type:"code",required:!0,handleInputChange:function(e){return n.handleCodeChange(e)}}],this.formFields=this.defaultFormFields,this.mfaOption=c.M.SMS,this.loading=!1}var t;return(0,s.Z)(e,[{key:"componentWillLoad",value:function(){this.setup()}},{key:"userHandler",value:function(){this.setup()}},{key:"setup",value:function(){this.user&&this.user.challengeName===c.C.SoftwareTokenMFA&&(this.mfaOption=c.M.TOTP,this.headerText===f.T.CONFIRM_SMS_CODE&&(this.headerText=f.T.CONFIRM_TOTP_CODE)),this.constructedFormFieldOptions=this.constructFormFieldOptions(this.formFields)}},{key:"handleCodeChange",value:function(e){this.code=e.target.value}},{key:"confirm",value:(t=(0,i.Z)(o().mark(function e(t){var n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.preventDefault(),n=this.user.challengeName===c.C.SoftwareTokenMFA?c.C.SoftwareTokenMFA:null,m.g&&"function"==typeof m.g.confirmSignIn){e.next=4;break}throw new Error(g.N);case 4:return this.loading=!0,e.prev=5,e.next=8,m.g.confirmSignIn(this.user,this.code,n);case 8:return e.next=10,(0,v.c)(this.user,this.handleAuthStateChange);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),(0,b.a)(e.t0);case 15:return e.prev=15,this.loading=!1,e.finish(15);case 18:case"end":return e.stop()}},e,this,[[5,12,15,18]])})),function(e){return t.apply(this,arguments)})},{key:"constructFormFieldOptions",value:function(e){var t=this,n=[];if(void 0!==e)return e.length<=0?this.defaultFormFields:(e.forEach(function(e){n.push("string"==typeof e||"code"!==e.type?e:Object.assign({handleInputChange:function(e){return t.handleCodeChange(e)}},e))}),n)}},{key:"render",value:function(){var e=this;return(0,h.h)(h.H,null,(0,h.h)("amplify-form-section",{headerText:l.o.get(this.headerText),handleSubmit:this.handleSubmit,submitButtonText:l.o.get(this.submitButtonText),loading:this.loading,secondaryFooterContent:(0,h.h)("span",null,(0,h.h)("amplify-button",{variant:"anchor",onClick:function(){return e.handleAuthStateChange(c.A.SignIn)}},l.o.get(f.T.BACK_TO_SIGN_IN)))},(0,h.h)("amplify-auth-fields",{formFields:this.constructedFormFieldOptions})))}}],[{key:"watchers",get:function(){return{user:["userHandler"]}}}]),e}(),F=function(){function e(t){var n=this;(0,a.Z)(this,e),(0,h.r)(this,t),this.handleSubmit=function(e){return n.confirmSignUp(e)},this.headerText=f.T.CONFIRM_SIGN_UP_HEADER_TEXT,this.submitButtonText=f.T.CONFIRM_SIGN_UP_SUBMIT_BUTTON_TEXT,this.formFields=[],this.handleAuthStateChange=b.d,this.usernameAlias="username",this.loading=!1,this.newFormFields=[],this.phoneNumber={countryDialCodeValue:g.h,phoneNumberValue:null}}var t,n;return(0,s.Z)(e,[{key:"componentWillLoad",value:function(){this.setup()}},{key:"formFieldsHandler",value:function(){this.buildFormFields()}},{key:"userHandler",value:function(){this.setup()}},{key:"setup",value:function(){this.userInput=this.user&&this.user.username,this._signUpAttrs=this.user&&this.user.signUpAttrs,(0,b.c)(this.usernameAlias),this.buildFormFields()}},{key:"buildDefaultFormFields",value:function(){var e=this;this.newFormFields=[{type:"".concat(this.usernameAlias),required:!0,handleInputChange:this.handleFormFieldInputChange("".concat(this.usernameAlias)),value:this.userInput,disabled:!!this.userInput,inputProps:{autocomplete:"username"}},{type:"code",label:l.o.get(f.T.CONFIRM_SIGN_UP_CODE_LABEL),placeholder:l.o.get(f.T.CONFIRM_SIGN_UP_CODE_PLACEHOLDER),required:!0,hint:(0,h.h)("div",null,l.o.get(f.T.CONFIRM_SIGN_UP_LOST_CODE)," ",(0,h.h)("amplify-button",{variant:"anchor",onClick:function(){return e.resendConfirmCode()}},l.o.get(f.T.CONFIRM_SIGN_UP_RESEND_CODE))),handleInputChange:this.handleFormFieldInputChange("code")}]}},{key:"buildFormFields",value:function(){var e=this;if(0===this.formFields.length)this.buildDefaultFormFields();else{var t=[];this.formFields.forEach(function(n){var r=Object.assign({},n);"code"===r.type&&(r.hint=(0,b.i)(r)?(0,h.h)("div",null,l.o.get(f.T.CONFIRM_SIGN_UP_LOST_CODE)," ",(0,h.h)("amplify-button",{variant:"anchor",onClick:function(){return e.resendConfirmCode()}},l.o.get(f.T.CONFIRM_SIGN_UP_RESEND_CODE))):r.hint),r.handleInputChange=function(t){return e.handleFormFieldInputWithCallback(t,n)},t.push(r)}),this.newFormFields=t}}},{key:"handleFormFieldInputChange",value:function(e){var t=this;switch(e){case"username":case"email":return function(e){return t.userInput=e.target.value};case"phone_number":return function(e){return(0,b.h)(e,t.phoneNumber)};case"code":return function(e){return t.code=e.target.value};default:return}}},{key:"setFieldValue",value:function(e){switch(e.type){case"username":case"email":this.userInput=void 0===e.value?"":e.value;break;case"phone_number":e.dialCode&&(this.phoneNumber.countryDialCodeValue=e.dialCode),this.phoneNumber.phoneNumberValue=e.value}}},{key:"handleFormFieldInputWithCallback",value:function(e,t){(t.handleInputChange?t.handleInputChange:function(e,t){t(e)})(e,this.handleFormFieldInputChange(t.type).bind(this))}},{key:"getUsername",value:function(){if(this.user&&this.user.username)return this.user.username;switch(this.usernameAlias){case"username":case"email":return this.userInput;case"phone_number":return(0,b.b)(this.phoneNumber)}}},{key:"resendConfirmCode",value:(n=(0,i.Z)(o().mark(function e(){var t;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(event&&event.preventDefault(),m.g&&"function"==typeof m.g.resendSignUp){e.next=3;break}throw new Error(g.N);case 3:if(e.prev=3,t=this.getUsername()){e.next=7;break}throw new Error(f.T.EMPTY_USERNAME);case 7:return e.next=9,m.g.resendSignUp(t.trim());case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),(0,b.a)(e.t0);case 14:case"end":return e.stop()}},e,this,[[3,11]])})),function(){return n.apply(this,arguments)})},{key:"confirmSignUp",value:(t=(0,i.Z)(o().mark(function e(t){var n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.preventDefault(),m.g&&"function"==typeof m.g.confirmSignUp){e.next=3;break}throw new Error(g.N);case 3:if(this.loading=!0,e.prev=4,n=this.getUsername()){e.next=8;break}throw new Error(f.T.EMPTY_USERNAME);case 8:return n=n.trim(),e.next=11,m.g.confirmSignUp(n,this.code);case 11:if(e.sent){e.next=14;break}throw new Error(l.o.get(f.T.CONFIRM_SIGN_UP_FAILED));case 14:if(!this._signUpAttrs||!this._signUpAttrs.password||""===this._signUpAttrs.password){e.next=19;break}return e.next=17,(0,v.h)(n,this._signUpAttrs.password,this.handleAuthStateChange);case 17:e.next=20;break;case 19:this.handleAuthStateChange(c.A.SignIn);case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(4),(0,b.a)(e.t0);case 25:return e.prev=25,this.loading=!1,e.finish(25);case 28:case"end":return e.stop()}},e,this,[[4,22,25,28]])})),function(e){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this;return(0,h.h)(h.H,null,(0,h.h)("amplify-form-section",{headerText:l.o.get(this.headerText),submitButtonText:l.o.get(this.submitButtonText),handleSubmit:this.handleSubmit,loading:this.loading,secondaryFooterContent:(0,h.h)("div",null,(0,h.h)("span",null,(0,h.h)("amplify-button",{variant:"anchor",onClick:function(){return e.handleAuthStateChange(c.A.SignIn)}},l.o.get(f.T.BACK_TO_SIGN_IN))))},(0,h.h)("amplify-auth-fields",{formFields:this.newFormFields})))}}],[{key:"watchers",get:function(){return{formFields:["formFieldsHandler"],user:["userHandler"]}}}]),e}(),C=new d.k("ForgotPassword"),w=function(){function e(t){var n=this;(0,a.Z)(this,e),(0,h.r)(this,t),this.headerText=f.T.RESET_YOUR_PASSWORD,this.sendButtonText=f.T.SEND_CODE,this.submitButtonText=f.T.SUBMIT,this.formFields=[],this.handleSend=function(e){return n.send(e)},this.handleSubmit=function(e){return n.submit(e)},this.handleAuthStateChange=b.d,this.usernameAlias="username",this.delivery=null,this.loading=!1,this.phoneNumber={countryDialCodeValue:g.h,phoneNumberValue:null},this.newFormFields=[],this.forgotPasswordAttrs={userInput:"",password:"",code:""}}var t,n;return(0,s.Z)(e,[{key:"componentWillLoad",value:function(){(0,b.c)(this.usernameAlias),this.buildFormFields()}},{key:"formFieldsHandler",value:function(){this.buildFormFields()}},{key:"buildFormFields",value:function(){var e=this;0===this.formFields.length?this.buildDefaultFormFields():this.formFields.forEach(function(t){var n=Object.assign({},t);n.handleInputChange=function(n){return e.handleFormFieldInputWithCallback(n,t)},e.newFormFields.push(n)})}},{key:"buildDefaultFormFields",value:function(){switch(this.usernameAlias){case"email":this.newFormFields=[{type:"email",required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"forgot-password-email-input"}}];break;case"phone_number":this.newFormFields=[{type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"forgot-password-phone-number-input"}}];break;case"username":default:this.newFormFields=[{type:"username",required:!0,handleInputChange:this.handleFormFieldInputChange("username"),inputProps:{"data-test":"forgot-password-username-input"}}]}}},{key:"handleFormFieldInputChange",value:function(e){var t=this;switch(e){case"username":case"email":return function(e){return t.forgotPasswordAttrs.userInput=e.target.value};case"phone_number":return function(e){return(0,b.h)(e,t.phoneNumber)};case"password":case"code":return function(n){return t.forgotPasswordAttrs[e]=n.target.value};default:return}}},{key:"setFieldValue",value:function(e,t){switch(e.type){case"username":case"email":t.userInput=void 0===e.value?"":e.value;break;case"phone_number":e.dialCode&&(this.phoneNumber.countryDialCodeValue=e.dialCode),this.phoneNumber.phoneNumberValue=e.value;break;case"password":case"code":t[e.type]=void 0===e.value?"":e.value}}},{key:"handleFormFieldInputWithCallback",value:function(e,t){(t.handleInputChange?t.handleInputChange:function(e,t){t(e)})(e,this.handleFormFieldInputChange(t.type).bind(this))}},{key:"send",value:(n=(0,i.Z)(o().mark(function e(t){var n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.preventDefault(),m.g&&"function"==typeof m.g.forgotPassword){e.next=3;break}throw new Error(g.N);case 3:this.loading=!0,e.t0=this.usernameAlias,e.next="phone_number"===e.t0?7:9;break;case 7:try{this.forgotPasswordAttrs.userInput=(0,b.b)(this.phoneNumber)}catch(r){(0,b.a)(r)}return e.abrupt("break",9);case 9:return e.prev=9,e.next=12,m.g.forgotPassword(this.forgotPasswordAttrs.userInput.trim());case 12:C.debug(n=e.sent),this.newFormFields=[{type:"code",required:!0,handleInputChange:this.handleFormFieldInputChange("code"),inputProps:{"data-test":"forgot-password-code-input"}},{type:"password",required:!0,handleInputChange:this.handleFormFieldInputChange("password"),label:l.o.get(f.T.NEW_PASSWORD_LABEL),placeholder:l.o.get(f.T.NEW_PASSWORD_PLACEHOLDER)}],this.delivery=n.CodeDeliveryDetails,e.next=21;break;case 18:e.prev=18,e.t1=e.catch(9),(0,b.a)(e.t1);case 21:return e.prev=21,this.loading=!1,e.finish(21);case 24:case"end":return e.stop()}},e,this,[[9,18,21,24]])})),function(e){return n.apply(this,arguments)})},{key:"submit",value:(t=(0,i.Z)(o().mark(function e(t){var n,r,i,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.preventDefault(),m.g&&"function"==typeof m.g.forgotPasswordSubmit){e.next=3;break}throw new Error(g.N);case 3:return this.loading=!0,e.prev=4,r=(n=this.forgotPasswordAttrs).userInput,i=n.code,a=n.password,e.next=8,m.g.forgotPasswordSubmit(r.trim(),i,a);case 8:C.debug(e.sent),this.handleAuthStateChange(c.A.SignIn),this.delivery=null,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),(0,b.a)(e.t0);case 17:return e.prev=17,this.loading=!1,e.finish(17);case 20:case"end":return e.stop()}},e,this,[[4,14,17,20]])})),function(e){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.delivery?function(t){return e.handleSubmit(t)}:function(t){return e.handleSend(t)},n=this.delivery?this.submitButtonText:this.sendButtonText;return(0,h.h)(h.H,null,(0,h.h)("amplify-form-section",{headerText:l.o.get(this.headerText),handleSubmit:t,loading:this.loading,secondaryFooterContent:(0,h.h)("amplify-button",{variant:"anchor",onClick:function(){return e.handleAuthStateChange(c.A.SignIn)},"data-test":"forgot-password-back-to-sign-in-link"},l.o.get(f.T.BACK_TO_SIGN_IN)),testDataPrefix:"forgot-password",submitButtonText:l.o.get(n)},(0,h.h)("amplify-auth-fields",{formFields:this.newFormFields})))}}],[{key:"watchers",get:function(){return{formFields:["formFieldsHandler"]}}}]),e}(),A=new d.k("amplify-require-new-password"),_=function(){function e(t){var n=this;(0,a.Z)(this,e),(0,h.r)(this,t),this.headerText=f.T.CHANGE_PASSWORD,this.submitButtonText=f.T.CHANGE_PASSWORD_ACTION,this.handleSubmit=function(e){return n.completeNewPassword(e)},this.handleAuthStateChange=b.d,this.formFields=[{type:c.a.Password,required:!0,handleInputChange:function(e){return n.handlePasswordChange(e)},label:l.o.get(f.T.NEW_PASSWORD_LABEL),placeholder:l.o.get(f.T.NEW_PASSWORD_PLACEHOLDER),inputProps:{"data-test":"require-new-password-password-input"}}],this.loading=!1,this.requiredAttributes={},this.newFormFields=this.formFields,this.phoneNumber={countryDialCodeValue:g.h,phoneNumberValue:" "}}var t,n;return(0,s.Z)(e,[{key:"userHandler",value:function(){this.setCurrentUser()}},{key:"handleRequiredAttributeInputChange",value:function(e,t){"phone_number"===e?this.formatPhoneNumber(t):this.requiredAttributes[e]=t.target.value}},{key:"setCurrentUser",value:(n=(0,i.Z)(o().mark(function e(){var t,n,i,a=this;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.user){e.next=13;break}return e.prev=1,e.next=4,m.g.currentAuthenticatedUser();case 4:(t=e.sent)&&(this.currentUser=t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),(0,b.a)(e.t0);case 11:e.next=14;break;case 13:this.currentUser=this.user;case 14:this.currentUser&&this.currentUser.challengeParam&&this.currentUser.challengeParam.requiredAttributes&&(n=this.currentUser.challengeParam.requiredAttributes,i=(0,b.g)(),n.forEach(function(e){var t={type:e,required:!0,label:i[e].label,placeholder:i[e].placeholder,handleInputChange:function(t){return a.handleRequiredAttributeInputChange(e,t)},inputProps:{"data-test":"require-new-password-".concat(e,"-input")}};a.newFormFields=[].concat((0,r.Z)(a.newFormFields),[t])}));case 15:case"end":return e.stop()}},e,this,[[1,8]])})),function(){return n.apply(this,arguments)})},{key:"componentWillLoad",value:function(){return this.setCurrentUser()}},{key:"handlePasswordChange",value:function(e){this.password=e.target.value}},{key:"formatPhoneNumber",value:function(e){(0,b.h)(e,this.phoneNumber);try{if(e.target.name===g.b&&this.phoneNumber.phoneNumberValue){var t=(0,b.b)(this.phoneNumber);this.requiredAttributes.phone_number=t}}catch(n){A.error("error in phone number field - ".concat(n))}}},{key:"completeNewPassword",value:(t=(0,i.Z)(o().mark(function e(t){var n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.preventDefault(),m.g&&"function"==typeof m.g.completeNewPassword){e.next=3;break}throw new Error(g.N);case 3:return this.loading=!0,e.prev=4,e.next=7,m.g.completeNewPassword(this.currentUser,this.password,this.requiredAttributes);case 7:A.debug("complete new password",n=e.sent),e.t0=n.challengeName,e.next=e.t0===c.C.SMSMFA?12:e.t0===c.C.MFASetup?14:17;break;case 12:return this.handleAuthStateChange(c.A.ConfirmSignIn,n),e.abrupt("break",19);case 14:return A.debug("TOTP setup",n.challengeParam),this.handleAuthStateChange(c.A.TOTPSetup,n),e.abrupt("break",19);case 17:return e.next=19,(0,v.c)(n,this.handleAuthStateChange);case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(4),(0,b.a)(e.t1);case 24:return e.prev=24,this.loading=!1,e.finish(24);case 27:case"end":return e.stop()}},e,this,[[4,21,24,27]])})),function(e){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this;return(0,h.h)(h.H,null,(0,h.h)("amplify-form-section",{headerText:l.o.get(this.headerText),handleSubmit:this.handleSubmit,loading:this.loading,secondaryFooterContent:(0,h.h)("amplify-button",{variant:"anchor",onClick:function(){return e.handleAuthStateChange(c.A.SignIn)}},l.o.get(f.T.BACK_TO_SIGN_IN)),submitButtonText:l.o.get(this.submitButtonText)},(0,h.h)("amplify-auth-fields",{formFields:this.newFormFields})))}}],[{key:"watchers",get:function(){return{user:["userHandler"]}}}]),e}(),I=function(){function e(t){var n=this;(0,a.Z)(this,e),(0,h.r)(this,t),this.handleSubmit=function(e){return n.signIn(e)},this.headerText=f.T.SIGN_IN_HEADER_TEXT,this.submitButtonText=f.T.SIGN_IN_ACTION,this.handleAuthStateChange=b.d,this.usernameAlias="username",this.formFields=[],this.hideSignUp=!1,this.newFormFields=[],this.loading=!1,this.phoneNumber={countryDialCodeValue:g.h,phoneNumberValue:null},this.signInAttributes={userInput:"",password:""}}var t;return(0,s.Z)(e,[{key:"componentWillLoad",value:function(){(0,b.c)(this.usernameAlias),this.buildFormFields()}},{key:"formFieldsHandler",value:function(){this.buildFormFields()}},{key:"handleFormFieldInputChange",value:function(e){var t=this;switch(e){case"username":case"email":return function(e){return t.signInAttributes.userInput=e.target.value};case"phone_number":return function(e){return(0,b.h)(e,t.phoneNumber)};case"password":return function(e){return t.signInAttributes.password=e.target.value};default:return function(){}}}},{key:"handleFormFieldInputWithCallback",value:function(e,t){(t.handleInputChange?t.handleInputChange:function(e,t){t(e)})(e,this.handleFormFieldInputChange(t.type).bind(this))}},{key:"signIn",value:(t=(0,i.Z)(o().mark(function e(t){var n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:switch(t&&t.preventDefault(),this.loading=!0,this.usernameAlias){case"phone_number":try{this.signInAttributes.userInput=(0,b.b)(this.phoneNumber)}catch(r){(0,b.a)(r)}}return n=this.signInAttributes.userInput.trim(),e.next=6,(0,v.h)(n,this.signInAttributes.password,this.handleAuthStateChange,this.usernameAlias);case 6:this.loading=!1;case 7:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"buildDefaultFormFields",value:function(){var e=this,t=[];switch(this.usernameAlias){case"email":t.push({type:"email",required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"sign-in-email-input",autocomplete:"username"}});break;case"phone_number":t.push({type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"sign-in-phone-number-input",autocomplete:"username"}});break;case"username":default:t.push({type:"username",required:!0,handleInputChange:this.handleFormFieldInputChange("username"),inputProps:{"data-test":"sign-in-username-input",autocomplete:"username"}})}t.push({type:"password",hint:(0,h.h)("div",null,l.o.get(f.T.FORGOT_PASSWORD_TEXT)," ",(0,h.h)("amplify-button",{variant:"anchor",onClick:function(){return e.handleAuthStateChange(c.A.ForgotPassword)},"data-test":"sign-in-forgot-password-link"},l.o.get(f.T.RESET_PASSWORD_TEXT))),required:!0,handleInputChange:this.handleFormFieldInputChange("password"),inputProps:{"data-test":"sign-in-password-input"}}),this.newFormFields=[].concat(t)}},{key:"buildFormFields",value:function(){var e=this;if(0===this.formFields.length)this.buildDefaultFormFields();else{var t=[];this.formFields.forEach(function(n){var r=Object.assign({},n);"password"===r.type&&(r.hint=(0,b.i)(r)?(0,h.h)("div",null,l.o.get(f.T.FORGOT_PASSWORD_TEXT)," ",(0,h.h)("amplify-button",{variant:"anchor",onClick:function(){return e.handleAuthStateChange(c.A.ForgotPassword)},"data-test":"sign-in-forgot-password-link"},l.o.get(f.T.RESET_PASSWORD_TEXT))):r.hint),r.handleInputChange=function(t){return e.handleFormFieldInputWithCallback(t,n)},e.setFieldValue(r,e.signInAttributes),t.push(r)}),this.newFormFields=t}}},{key:"setFieldValue",value:function(e,t){switch(e.type){case"username":case"email":t.userInput=void 0===e.value?"":e.value;break;case"phone_number":e.dialCode&&(this.phoneNumber.countryDialCodeValue=e.dialCode),this.phoneNumber.phoneNumberValue=e.value;break;case"password":t.password=void 0===e.value?"":e.value}}},{key:"render",value:function(){var e=this;return(0,h.h)(h.H,null,(0,h.h)("amplify-form-section",{headerText:l.o.get(this.headerText),handleSubmit:this.handleSubmit,testDataPrefix:"sign-in"},(0,h.h)("div",{slot:"subtitle"},(0,h.h)("slot",{name:"header-subtitle"})),(0,h.h)("slot",{name:"federated-buttons"},(0,h.h)("amplify-federated-buttons",{handleAuthStateChange:this.handleAuthStateChange,federated:this.federated})),!(0,p.xb)(this.federated)&&(0,h.h)("amplify-strike",null,"or"),(0,h.h)("amplify-auth-fields",{formFields:this.newFormFields}),(0,h.h)("div",{slot:"amplify-form-section-footer",class:"sign-in-form-footer"},(0,h.h)("slot",{name:"footer"},!this.hideSignUp&&(0,h.h)("slot",{name:"secondary-footer-content"},(0,h.h)("span",null,l.o.get(f.T.NO_ACCOUNT_TEXT)," ",(0,h.h)("amplify-button",{variant:"anchor",onClick:function(){return e.handleAuthStateChange(c.A.SignUp)},"data-test":"sign-in-create-account-link"},l.o.get(f.T.CREATE_ACCOUNT_TEXT)))),(0,h.h)("div",{class:this.hideSignUp?"full-width-footer-content":""},(0,h.h)("slot",{name:"primary-footer-content"},(0,h.h)("amplify-button",{type:"submit",disabled:this.loading,"data-test":"sign-in-sign-in-button"},this.loading?(0,h.h)("amplify-loading-spinner",null):(0,h.h)("span",null,l.o.get(this.submitButtonText)))))))))}}],[{key:"watchers",get:function(){return{formFields:["formFieldsHandler"]}}}]),e}();I.style=":host{--footer-size:var(--amplify-text-sm);--footer-color:var(--amplify-grey);--footer-font-family:var(--amplify-font-family);--font-weight:var(--amplify-font-weight)}.sign-in-form-footer{font-family:var(--footer-font-family);font-size:var(--footer-size);color:var(--footer-color);font-weight:--font-weight;display:-ms-flexbox;display:flex;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-ms-flex-align:center;align-items:center;-ms-flex-pack:distribute;justify-content:space-around}.sign-in-form-footer amplify-button{margin-bottom:0.625rem}@media (min-width: 672px){.sign-in-form-footer{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:baseline;align-items:baseline}.sign-in-form-footer amplify-button{margin-bottom:0}}.sign-in-form-footer *+*{margin-bottom:15px}.full-width-footer-content{width:100%}";var T=function(){function e(t){var n=this;(0,a.Z)(this,e),(0,h.r)(this,t),this.handleSubmit=function(e){return n.signUp(e)},this.handleSignUp=function(e){return n.authSignUp(e)},this.headerText=f.T.SIGN_UP_HEADER_TEXT,this.submitButtonText=f.T.SIGN_UP_SUBMIT_BUTTON_TEXT,this.haveAccountText=f.T.SIGN_UP_HAVE_ACCOUNT_TEXT,this.signInText=f.T.SIGN_IN_TEXT,this.formFields=[],this.handleAuthStateChange=b.d,this.usernameAlias="username",this.newFormFields=[],this.phoneNumber={countryDialCodeValue:g.h,phoneNumberValue:null},this.loading=!1,this.signUpAttributes={username:"",password:"",attributes:{}}}var t,n;return(0,s.Z)(e,[{key:"handleFormFieldInputChange",value:function(e){var t=this;switch(e){case"username":return function(e){return t.signUpAttributes.username=e.target.value};case"password":return function(e){return t.signUpAttributes.password=e.target.value};case"email":return function(e){return t.signUpAttributes.attributes.email=e.target.value};case"phone_number":return function(e){return(0,b.h)(e,t.phoneNumber)};default:return function(n){return t.signUpAttributes.attributes[e]=n.target.value}}}},{key:"handleFormFieldInputWithCallback",value:function(e,t){(t.handleInputChange?t.handleInputChange:function(e,t){t(e)})(e,this.handleFormFieldInputChange(t.type).bind(this))}},{key:"authSignUp",value:(n=(0,i.Z)(o().mark(function e(t){var n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.g.signUp(t);case 2:if(n=e.sent){e.next=5;break}throw new Error(f.T.SIGN_UP_FAILED);case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)})},{key:"assignPhoneNumberToSignUpAttributes",value:function(){if(this.phoneNumber.phoneNumberValue)try{this.signUpAttributes.attributes.phone_number=(0,b.b)(this.phoneNumber)}catch(e){(0,b.a)(e)}}},{key:"assignUserNameAliasToSignUpAttributes",value:function(){switch(this.usernameAlias){case"email":case"phone_number":this.signUpAttributes.username=this.signUpAttributes.attributes[this.usernameAlias]}}},{key:"assignFormInputToSignUpAttributes",value:function(){this.assignPhoneNumberToSignUpAttributes(),this.assignUserNameAliasToSignUpAttributes()}},{key:"validateSignUpAttributes",value:function(){if(!this.signUpAttributes.username)throw this.usernameAlias===c.U.email?new Error(f.T.EMPTY_EMAIL):this.usernameAlias===c.U.phone_number?new Error(f.T.EMPTY_PHONE):new Error(f.T.EMPTY_USERNAME);if(this.signUpAttributes.username.indexOf(" ")>=0)throw new Error(f.T.USERNAME_REMOVE_WHITESPACE);if(this.signUpAttributes.password!==this.signUpAttributes.password.trim())throw new Error(f.T.PASSWORD_REMOVE_WHITESPACE)}},{key:"signUp",value:(t=(0,i.Z)(o().mark(function e(t){var n,r;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.preventDefault(),m.g&&"function"==typeof m.g.signUp){e.next=3;break}throw new Error(g.N);case 3:return this.loading=!0,this.assignFormInputToSignUpAttributes(),e.prev=5,this.validateSignUpAttributes(),e.next=9,this.handleSignUp(this.signUpAttributes);case 9:if(!(n=e.sent).userConfirmed){e.next=15;break}return e.next=13,(0,v.h)(this.signUpAttributes.username,this.signUpAttributes.password,this.handleAuthStateChange);case 13:e.next=17;break;case 15:r=Object.assign({},this.signUpAttributes),this.handleAuthStateChange(c.A.ConfirmSignUp,Object.assign(Object.assign({},n.user),{signUpAttrs:r}));case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(5),(0,b.a)(e.t0);case 22:return e.prev=22,this.loading=!1,e.finish(22);case 25:case"end":return e.stop()}},e,this,[[5,19,22,25]])})),function(e){return t.apply(this,arguments)})},{key:"buildDefaultFormFields",value:function(){switch(this.usernameAlias){case"email":this.newFormFields=[{type:"email",placeholder:l.o.get(f.T.SIGN_UP_EMAIL_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"sign-up-email-input",autocomplete:"username"}},{type:"password",placeholder:l.o.get(f.T.SIGN_UP_PASSWORD_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("password"),inputProps:{"data-test":"sign-up-password-input",autocomplete:"new-password"}},{type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"sign-up-phone-number-input",autocomplete:"tel-national"}}];break;case"phone_number":this.newFormFields=[{type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"sign-up-phone-number-input",autocomplete:"username"}},{type:"password",placeholder:l.o.get(f.T.SIGN_UP_PASSWORD_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("password"),inputProps:{"data-test":"sign-up-password-input",autocomplete:"new-password"}},{type:"email",placeholder:l.o.get(f.T.SIGN_UP_EMAIL_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"sign-up-email-input",autocomplete:"email"}}];break;case"username":default:this.newFormFields=[{type:"username",placeholder:l.o.get(f.T.SIGN_UP_USERNAME_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("username"),inputProps:{"data-test":"sign-up-username-input",autocomplete:"username"}},{type:"password",placeholder:l.o.get(f.T.SIGN_UP_PASSWORD_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("password"),inputProps:{"data-test":"sign-up-password-input",autocomplete:"new-password"}},{type:"email",placeholder:l.o.get(f.T.SIGN_UP_EMAIL_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"sign-up-email-input"}},{type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"sign-up-phone-number-input"}}]}}},{key:"buildFormFields",value:function(){var e=this;if(0===this.formFields.length)this.buildDefaultFormFields();else{var t=[];this.formFields.forEach(function(n){var r=Object.assign({},n);r.handleInputChange=function(t){return e.handleFormFieldInputWithCallback(t,n)},e.setFieldValue(n,e.signUpAttributes),t.push(r)}),this.newFormFields=t}}},{key:"setFieldValue",value:function(e,t){switch(e.type){case"username":t.username=void 0===e.value?"":e.value;break;case"password":t.password=void 0===e.value?"":e.value;break;case"email":t.attributes.email=e.value;break;case"phone_number":e.dialCode&&(this.phoneNumber.countryDialCodeValue=e.dialCode),this.phoneNumber.phoneNumberValue=e.value;break;default:t.attributes[e.type]=e.value}}},{key:"componentWillLoad",value:function(){(0,b.c)(this.usernameAlias),this.buildFormFields()}},{key:"formFieldsHandler",value:function(){this.buildFormFields()}},{key:"render",value:function(){var e=this;return(0,h.h)(h.H,null,(0,h.h)("amplify-form-section",{headerText:l.o.get(this.headerText),handleSubmit:this.handleSubmit,testDataPrefix:"sign-up"},(0,h.h)("div",{slot:"subtitle"},(0,h.h)("slot",{name:"header-subtitle"})),(0,h.h)("amplify-auth-fields",{formFields:this.newFormFields}),(0,h.h)("div",{class:"sign-up-form-footer",slot:"amplify-form-section-footer"},(0,h.h)("slot",{name:"footer"},(0,h.h)("slot",{name:"secondary-footer-content"},(0,h.h)("span",null,l.o.get(this.haveAccountText)," ",(0,h.h)("amplify-button",{variant:"anchor",onClick:function(){return e.handleAuthStateChange(c.A.SignIn)},"data-test":"sign-up-sign-in-link"},l.o.get(this.signInText)))),(0,h.h)("slot",{name:"primary-footer-content"},(0,h.h)("amplify-button",{type:"submit","data-test":"sign-up-create-account-button",disabled:this.loading},this.loading?(0,h.h)("amplify-loading-spinner",null):(0,h.h)("span",null,l.o.get(this.submitButtonText))))))))}}],[{key:"watchers",get:function(){return{formFields:["formFieldsHandler"]}}}]),e}();T.style="amplify-sign-up{--footer-font-family:var(--amplify-font-family);--footer-font-size:var(--amplify-text-sm);--footer-color:var(--amplify-grey);--font-weight:var(--amplify-font-weight)}.sign-up-form-footer{font-family:var(--footer-font-family);font-size:var(--footer-font-size);color:var(--footer-color);font-weight:--font-weight;display:-ms-flexbox;display:flex;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-ms-flex-align:center;align-items:center;-ms-flex-pack:distribute;justify-content:space-around}.sign-up-form-footer amplify-button{margin-bottom:0.625rem}@media (min-width: 672px){.sign-up-form-footer{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:baseline;align-items:baseline}.sign-up-form-footer amplify-button{margin-bottom:0}}.sign-up-form-footer *+*{margin-bottom:15px}";var k=new d.k("AmplifyVerifyContact"),S=function(){function e(t){(0,a.Z)(this,e),(0,h.r)(this,t),this.handleAuthStateChange=b.d,this.loading=!1}var t,n;return(0,s.Z)(e,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.verifyAttr?this.submit(this.code):this.verify(this.contact)}},{key:"submit",value:(n=(0,i.Z)(o().mark(function e(t){var n;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.verifyAttr,m.g&&"function"==typeof m.g.verifyCurrentUserAttributeSubmit){e.next=3;break}throw new Error(g.N);case 3:return this.loading=!0,e.prev=4,e.next=7,m.g.verifyCurrentUserAttributeSubmit(n,t);case 7:k.debug(e.sent),this.handleAuthStateChange(c.A.SignedIn,this.user),this.verifyAttr=null,e.next=17;break;case 13:e.prev=13,e.t0=e.catch(4),(0,b.a)(e.t0),k.error(e.t0);case 17:return e.prev=17,this.loading=!1,e.finish(17);case 20:case"end":return e.stop()}},e,this,[[4,13,17,20]])})),function(e){return n.apply(this,arguments)})},{key:"verify",value:(t=(0,i.Z)(o().mark(function e(t){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return k.error("Neither Email nor Phone Number selected"),e.abrupt("return");case 3:if(m.g&&"function"==typeof m.g.verifyCurrentUserAttribute){e.next=5;break}throw new Error(g.N);case 5:return this.loading=!0,e.prev=6,e.next=9,m.g.verifyCurrentUserAttribute(t);case 9:k.debug(e.sent),this.verifyAttr=t,e.next=18;break;case 14:e.prev=14,e.t0=e.catch(6),(0,b.a)(e.t0),k.error(e.t0);case 18:return e.prev=18,this.loading=!1,e.finish(18);case 21:case"end":return e.stop()}},e,this,[[6,14,18,21]])})),function(e){return t.apply(this,arguments)})},{key:"handleInputChange",value:function(e){var t=e.target.name;"code"===t?this.code=e.target.value:"contact"===t&&(this.contact=e.target.value)}},{key:"renderSubmit",value:function(){var e=this;return(0,h.h)("div",null,(0,h.h)("amplify-input",{inputProps:{autocomplete:"off","data-test":"verify-contact-code-input"},name:"code",placeholder:l.o.get(f.T.CODE_PLACEHOLDER),handleInputChange:function(t){return e.handleInputChange(t)}}))}},{key:"renderVerify",value:function(){var e=this,t=this.user;if(!t)return k.debug("No user to verify"),null;var n=t.unverified;if(!n)return k.debug("Unverified variable does not exist on user"),null;var r=n.phone_number;return(0,h.h)("div",null,n.email&&(0,h.h)("amplify-radio-button",{label:l.o.get(f.T.VERIFY_CONTACT_EMAIL_LABEL),key:"email",name:"contact",value:"email",handleInputChange:function(t){return e.handleInputChange(t)},inputProps:{"data-test":"verify-contact-email-radio"}}),r&&(0,h.h)("amplify-radio-button",{label:l.o.get(f.T.VERIFY_CONTACT_PHONE_LABEL),key:"phone_number",name:"contact",value:"phone_number",handleInputChange:function(t){return e.handleInputChange(t)},inputProps:{"data-test":"verify-contact-phone-number-radio"}}))}},{key:"render",value:function(){var e=this;return(0,h.h)(h.H,null,(0,h.h)("amplify-form-section",{handleSubmit:function(t){return e.handleSubmit(t)},headerText:l.o.get(f.T.VERIFY_CONTACT_HEADER_TEXT),loading:this.loading,secondaryFooterContent:(0,h.h)("span",null,(0,h.h)("amplify-button",{variant:"anchor",onClick:function(){return e.handleAuthStateChange(c.A.SignedIn,e.user)},"data-test":"verify-contact-skip-link"},"Skip")),submitButtonText:l.o.get(this.verifyAttr?f.T.VERIFY_CONTACT_SUBMIT_LABEL:f.T.VERIFY_CONTACT_VERIFY_LABEL)},this.verifyAttr?this.renderSubmit():this.renderVerify()))}}]),e}()}}]);